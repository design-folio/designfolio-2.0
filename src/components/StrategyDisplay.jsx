import HeadlineSection from "@/components/HeadlineSection";
import { useStrategyProcessor } from "@/hooks/useStrategyProcessor";
import React from "react";
import { ContentCalendarSection } from "./ContentCalendarSection";
import { KeywordsSection } from "./KeywordsSection";
import { ChecklistSection } from "./ChecklistSection";
import { GeneralSection } from "./GeneralSection";
import Button from "@/components/button";
import { RefreshCw } from "lucide-react";

export default function StrategyDisplay({ strategy, onRestart }) {
  const sections = useStrategyProcessor(strategy);

  if (!sections) {
    return null;
  }

  const handleDownloadPDF = () => {
    // const pdfSections = sections.map((section) => ({
    //   title: section.title,
    //   content: section.content.split("\n").filter(Boolean),
    // }));
    // generatePDF(pdfSections);
  };

  const renderSection = (section, index) => {
    switch (section.type) {
      case "headline":
        return (
          <HeadlineSection
            key={index}
            title={section.title}
            contentText={section.content}
          />
        );
      case "calendar":
        return (
          <ContentCalendarSection
            key={index}
            title={section.title}
            contentText={section.content}
          />
        );
      case "keywords":
        return (
          <KeywordsSection
            key={index}
            title={section.title}
            contentText={section.content}
          />
        );
      case "checklist":
        return (
          <ChecklistSection
            key={index}
            title={section.title}
            contentText={section.content}
          />
        );
      default:
        return (
          <GeneralSection
            key={index}
            title={section.title}
            contentText={section.content}
          />
        );
    }
  };

  return (
    <div className="mt-8 space-y-6 animate-fade-in">
      <div className="flex justify-between items-center mb-8">
        <Button
          onClick={onRestart}
          variant="outline"
          className="flex items-center gap-2"
          text={"Start Over"}
          icon={<RefreshCw className="h-4 w-4" />}
        />

        <Button onClick={handleDownloadPDF} />
      </div>

      <div className="grid gap-6 w-full">
        {sections.map((section, index) => renderSection(section, index))}
      </div>

      <div className="flex justify-center items-center gap-2 py-8 text-gray-600">
        Generated by{" "}
        <a
          href="https://www.designfolio.me/"
          target="_blank"
          rel="noopener noreferrer"
        >
          <svg
            width="139"
            height="32"
            viewBox="0 0 139 32"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M15.506 0L17.7725 10.0341L26.4703 4.54159L20.9779 13.2394L31.0119 15.506L20.9779 17.7725L26.4703 26.4703L17.7725 20.9779L15.506 31.0119L13.2394 20.9779L4.54159 26.4703L10.0341 17.7725L0 15.506L10.0341 13.2394L4.54159 4.54159L13.2394 10.0341L15.506 0Z"
              fill="#FF553E"
            />
            <path
              d="M44.337 23.2589C41.5537 23.2589 39.8215 21.2152 39.8215 18.2373C39.8215 15.24 41.5732 13.099 44.4732 13.099C45.8162 13.099 47.0034 13.6634 47.6068 14.6171V8.52511H49.9619V23.0059H47.782L47.6263 21.5072C47.0424 22.6166 45.7967 23.2589 44.337 23.2589ZM44.8625 21.079C46.5169 21.079 47.5873 19.8917 47.5873 18.1595C47.5873 16.4272 46.5169 15.2205 44.8625 15.2205C43.2081 15.2205 42.196 16.4467 42.196 18.1595C42.196 19.8723 43.2081 21.079 44.8625 21.079ZM56.7379 23.2589C53.8768 23.2589 51.872 21.1763 51.872 18.1984C51.872 15.1816 53.8378 13.099 56.66 13.099C59.5406 13.099 61.3702 15.0259 61.3702 18.0232V18.7434L54.1298 18.7628C54.3049 20.4562 55.2003 21.3125 56.7768 21.3125C58.0808 21.3125 58.9372 20.8065 59.2097 19.8917H61.4091C61.0003 21.9938 59.2486 23.2589 56.7379 23.2589ZM56.6795 15.0453C55.2781 15.0453 54.4217 15.8044 54.1882 17.2447H59.0151C59.0151 15.9212 58.1003 15.0453 56.6795 15.0453ZM62.531 20.0864H64.7887C64.8082 20.9233 65.431 21.4488 66.521 21.4488C67.6304 21.4488 68.2337 21.0011 68.2337 20.3004C68.2337 19.8139 67.9807 19.4635 67.1243 19.2689L65.3921 18.8602C63.6598 18.4709 62.8229 17.6534 62.8229 16.1158C62.8229 14.2279 64.4189 13.099 66.6377 13.099C68.7982 13.099 70.2579 14.3447 70.2774 16.2131H68.0196C68.0002 15.3957 67.4552 14.8702 66.5404 14.8702C65.6062 14.8702 65.0612 15.2984 65.0612 16.0185C65.0612 16.5635 65.4894 16.9138 66.3069 17.1085L68.0391 17.5172C69.6546 17.887 70.472 18.6266 70.472 20.1058C70.472 22.0522 68.8176 23.2589 66.4431 23.2589C64.0491 23.2589 62.531 21.9743 62.531 20.0864ZM73.4672 11.4641C72.6498 11.4641 72.0075 10.8218 72.0075 10.0238C72.0075 9.22579 72.6498 8.60296 73.4672 8.60296C74.2458 8.60296 74.8881 9.22579 74.8881 10.0238C74.8881 10.8218 74.2458 11.4641 73.4672 11.4641ZM72.28 23.0059V13.391H74.6545V23.0059H72.28ZM76.5628 17.9843C76.5628 15.1816 78.3924 13.0795 81.1367 13.0795C82.577 13.0795 83.7059 13.6829 84.2703 14.7145L84.4066 13.391H86.6059V22.5193C86.6059 25.7307 84.6791 27.7355 81.5649 27.7355C78.8011 27.7355 76.9132 26.1589 76.6212 23.5898H78.9958C79.1515 24.8354 80.1052 25.575 81.5649 25.575C83.1998 25.575 84.2509 24.5435 84.2509 22.9475V21.3515C83.6475 22.2468 82.4602 22.8112 81.0783 22.8112C78.3535 22.8112 76.5628 20.7676 76.5628 17.9843ZM78.9568 17.9259C78.9568 19.5414 79.9884 20.7481 81.5455 20.7481C83.1804 20.7481 84.1925 19.5998 84.1925 17.9259C84.1925 16.291 83.1998 15.1621 81.5455 15.1621C79.9689 15.1621 78.9568 16.3494 78.9568 17.9259ZM91.4379 23.0059H89.0633V13.391H91.2627L91.4573 14.6366C92.0607 13.6634 93.2285 13.099 94.5325 13.099C96.946 13.099 98.1917 14.5977 98.1917 17.089V23.0059H95.8171V17.6534C95.8171 16.038 95.0191 15.2594 93.7929 15.2594C92.3332 15.2594 91.4379 16.2715 91.4379 17.8286V23.0059ZM100.33 13.391H101.692L101.887 12.1842C102.276 9.77076 103.619 8.52511 105.819 8.52511C106.208 8.52511 106.636 8.54457 106.987 8.62242L106.675 10.5882C106.403 10.5882 106.15 10.5688 105.877 10.5688C104.846 10.5688 104.32 11.0553 104.145 12.1842L103.95 13.391H106.208L105.897 15.2984H103.658L102.432 23.0059H100.174L101.401 15.2984H100.019L100.33 13.391ZM106.098 18.8796C106.098 15.6682 108.609 13.1379 111.742 13.1379C114.486 13.1379 116.335 14.8896 116.335 17.4977C116.335 20.7092 113.844 23.2394 110.691 23.2394C107.947 23.2394 106.098 21.4877 106.098 18.8796ZM108.433 18.7045C108.433 20.2226 109.348 21.2152 110.827 21.2152C112.579 21.2152 114 19.6387 114 17.6729C114 16.1353 113.085 15.1427 111.625 15.1427C109.874 15.1427 108.433 16.7192 108.433 18.7045ZM119.701 23.0059H117.424L119.701 8.52511H121.998L119.701 23.0059ZM125.153 11.4446C124.452 11.4446 123.965 10.9191 123.965 10.2573C123.965 9.40096 124.724 8.62242 125.6 8.62242C126.281 8.62242 126.787 9.12847 126.787 9.80969C126.787 10.6466 126.009 11.4446 125.153 11.4446ZM122.194 23.0059L123.712 13.391H125.989L124.471 23.0059H122.194ZM127.044 18.8796C127.044 15.6682 129.554 13.1379 132.688 13.1379C135.432 13.1379 137.281 14.8896 137.281 17.4977C137.281 20.7092 134.79 23.2394 131.637 23.2394C128.893 23.2394 127.044 21.4877 127.044 18.8796ZM129.379 18.7045C129.379 20.2226 130.294 21.2152 131.773 21.2152C133.525 21.2152 134.946 19.6387 134.946 17.6729C134.946 16.1353 134.031 15.1427 132.571 15.1427C130.82 15.1427 129.379 16.7192 129.379 18.7045Z"
              fill="#334155"
            />
          </svg>
        </a>
      </div>
    </div>
  );
}
